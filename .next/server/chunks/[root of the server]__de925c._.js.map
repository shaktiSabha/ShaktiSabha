{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file://D%3A/code/shakti-sabha/latest/ShaktiSabha/src/lib/mongodb.ts"],"sourcesContent":["import mongoose from 'mongoose';\r\n\r\nconst MONGODB_URI = process.env.MONGODB_URI || 'mongodb://localhost:27017/shakti-sabha';\r\n\r\nif (!MONGODB_URI) {\r\n  throw new Error('Please define the MONGODB_URI environment variable inside .env.local');\r\n}\r\n\r\n// Use mongoose connection state instead of custom flag\r\nasync function connectDB() {\r\n  // Check if already connected (0 = disconnected, 1 = connected, 2 = connecting, 3 = disconnecting)\r\n  if (mongoose.connection.readyState >= 1) {\r\n    return;\r\n  }\r\n\r\n  try {\r\n    await mongoose.connect(MONGODB_URI, {\r\n      // Connection pool settings to prevent ECONNRESET\r\n      maxPoolSize: 10,\r\n      minPoolSize: 2,\r\n      socketTimeoutMS: 45000,\r\n      serverSelectionTimeoutMS: 5000,\r\n      // Prevent connection issues\r\n      retryWrites: true,\r\n      retryReads: true,\r\n    });\r\n    console.log('MongoDB connected successfully');\r\n  } catch (error) {\r\n    console.error('MongoDB connection error:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport default connectDB; "],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW,IAAI;AAE/C,uCAAkB;;AAElB;AAEA,uDAAuD;AACvD,eAAe;IACb,kGAAkG;IAClG,IAAI,yGAAA,CAAA,UAAQ,CAAC,UAAU,CAAC,UAAU,IAAI,GAAG;QACvC;IACF;IAEA,IAAI;QACF,MAAM,yGAAA,CAAA,UAAQ,CAAC,OAAO,CAAC,aAAa;YAClC,iDAAiD;YACjD,aAAa;YACb,aAAa;YACb,iBAAiB;YACjB,0BAA0B;YAC1B,4BAA4B;YAC5B,aAAa;YACb,YAAY;QACd;QACA,QAAQ,GAAG,CAAC;IACd,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,MAAM;IACR;AACF;uCAEe"}},
    {"offset": {"line": 96, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 102, "column": 0}, "map": {"version":3,"sources":["file://D%3A/code/shakti-sabha/latest/ShaktiSabha/src/models/Testimonial.ts"],"sourcesContent":["import mongoose from 'mongoose';\r\n\r\nconst testimonialSchema = new mongoose.Schema({\r\n  name: {\r\n    type: String,\r\n    required: [true, 'Name is required'],\r\n    trim: true,\r\n    maxlength: [100, 'Name cannot be more than 100 characters']\r\n  },\r\n  designation: {\r\n    type: String,\r\n    trim: true,\r\n    maxlength: [150, 'Designation cannot be more than 150 characters']\r\n  },\r\n  company: {\r\n    type: String,\r\n    trim: true,\r\n    maxlength: [100, 'Company cannot be more than 100 characters']\r\n  },\r\n  message: {\r\n    type: String,\r\n    required: [true, 'Message is required'],\r\n    trim: true,\r\n    maxlength: [1000, 'Message cannot be more than 1000 characters']\r\n  },\r\n\r\n  imageUrl: {\r\n    type: String,\r\n    default: '/placeholder-testimonial.svg'\r\n  },\r\n  imagePublicId: {\r\n    type: String, // For Cloudinary image management\r\n    default: ''\r\n  },\r\n  location: {\r\n    type: String,\r\n    trim: true,\r\n    maxlength: [100, 'Location cannot be more than 100 characters']\r\n  },\r\n  memberSince: {\r\n    type: String,\r\n    default: '2024'\r\n  },\r\n  status: {\r\n    type: String,\r\n    enum: ['draft', 'published'],\r\n    default: 'draft'\r\n  },\r\n  featured: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  category: {\r\n    type: String,\r\n    enum: ['Workshop', 'Training', 'Community', 'Counseling', 'Other'],\r\n    default: 'Other'\r\n  },\r\n  addedBy: {\r\n    type: String,\r\n    default: 'Admin User'\r\n  }\r\n}, {\r\n  timestamps: true // This adds createdAt and updatedAt fields automatically\r\n});\r\n\r\n// Create indexes for better performance\r\ntestimonialSchema.index({ status: 1, createdAt: -1 });\r\ntestimonialSchema.index({ featured: 1, status: 1 });\r\ntestimonialSchema.index({ category: 1, status: 1 });\r\ntestimonialSchema.index({ name: 'text', message: 'text' });\r\n\r\nconst Testimonial = mongoose.models.Testimonial || mongoose.model('Testimonial', testimonialSchema);\r\n\r\nexport default Testimonial; "],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,oBAAoB,IAAI,yGAAA,CAAA,UAAQ,CAAC,MAAM,CAAC;IAC5C,MAAM;QACJ,MAAM;QACN,UAAU;YAAC;YAAM;SAAmB;QACpC,MAAM;QACN,WAAW;YAAC;YAAK;SAA0C;IAC7D;IACA,aAAa;QACX,MAAM;QACN,MAAM;QACN,WAAW;YAAC;YAAK;SAAiD;IACpE;IACA,SAAS;QACP,MAAM;QACN,MAAM;QACN,WAAW;YAAC;YAAK;SAA6C;IAChE;IACA,SAAS;QACP,MAAM;QACN,UAAU;YAAC;YAAM;SAAsB;QACvC,MAAM;QACN,WAAW;YAAC;YAAM;SAA8C;IAClE;IAEA,UAAU;QACR,MAAM;QACN,SAAS;IACX;IACA,eAAe;QACb,MAAM;QACN,SAAS;IACX;IACA,UAAU;QACR,MAAM;QACN,MAAM;QACN,WAAW;YAAC;YAAK;SAA8C;IACjE;IACA,aAAa;QACX,MAAM;QACN,SAAS;IACX;IACA,QAAQ;QACN,MAAM;QACN,MAAM;YAAC;YAAS;SAAY;QAC5B,SAAS;IACX;IACA,UAAU;QACR,MAAM;QACN,SAAS;IACX;IACA,UAAU;QACR,MAAM;QACN,MAAM;YAAC;YAAY;YAAY;YAAa;YAAc;SAAQ;QAClE,SAAS;IACX;IACA,SAAS;QACP,MAAM;QACN,SAAS;IACX;AACF,GAAG;IACD,YAAY,KAAK,yDAAyD;AAC5E;AAEA,wCAAwC;AACxC,kBAAkB,KAAK,CAAC;IAAE,QAAQ;IAAG,WAAW,CAAC;AAAE;AACnD,kBAAkB,KAAK,CAAC;IAAE,UAAU;IAAG,QAAQ;AAAE;AACjD,kBAAkB,KAAK,CAAC;IAAE,UAAU;IAAG,QAAQ;AAAE;AACjD,kBAAkB,KAAK,CAAC;IAAE,MAAM;IAAQ,SAAS;AAAO;AAExD,MAAM,cAAc,yGAAA,CAAA,UAAQ,CAAC,MAAM,CAAC,WAAW,IAAI,yGAAA,CAAA,UAAQ,CAAC,KAAK,CAAC,eAAe;uCAElE"}},
    {"offset": {"line": 217, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 223, "column": 0}, "map": {"version":3,"sources":["file://D%3A/code/shakti-sabha/latest/ShaktiSabha/src/app/api/testimonials/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport connectDB from '@/lib/mongodb';\r\nimport Testimonial from '@/models/Testimonial';\r\n\r\nexport async function GET() {\r\n  try {\r\n    await connectDB();\r\n    const testimonials = await Testimonial.find({}).sort({ createdAt: -1 });\r\n    return NextResponse.json(testimonials);\r\n  } catch (error) {\r\n    console.error('Error fetching testimonials:', error);\r\n    return NextResponse.json(\r\n      { error: 'Failed to fetch testimonials' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    await connectDB();\r\n    const body = await request.json();\r\n    const { \r\n      name, \r\n      message, \r\n      memberSince, \r\n      status = 'draft'\r\n    } = body;\r\n\r\n    if (!name || !message) {\r\n      return NextResponse.json(\r\n        { error: 'Name and message are required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const newTestimonial = new Testimonial({\r\n      name,\r\n      message,\r\n      memberSince: memberSince || '2024',\r\n      status,\r\n      featured: false,\r\n      category: 'Community'\r\n    });\r\n\r\n    const savedTestimonial = await newTestimonial.save();\r\n    return NextResponse.json(savedTestimonial, { status: 201 });\r\n  } catch (error) {\r\n    console.error('Create testimonial error:', error);\r\n    return NextResponse.json(\r\n      { error: 'Failed to create testimonial' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n} "],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,CAAA,GAAA,uHAAA,CAAA,UAAS,AAAD;QACd,MAAM,eAAe,MAAM,8HAAA,CAAA,UAAW,CAAC,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC;YAAE,WAAW,CAAC;QAAE;QACrE,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA+B,GACxC;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,CAAA,GAAA,uHAAA,CAAA,UAAS,AAAD;QACd,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EACJ,IAAI,EACJ,OAAO,EACP,WAAW,EACX,SAAS,OAAO,EACjB,GAAG;QAEJ,IAAI,CAAC,QAAQ,CAAC,SAAS;YACrB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAgC,GACzC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,iBAAiB,IAAI,8HAAA,CAAA,UAAW,CAAC;YACrC;YACA;YACA,aAAa,eAAe;YAC5B;YACA,UAAU;YACV,UAAU;QACZ;QAEA,MAAM,mBAAmB,MAAM,eAAe,IAAI;QAClD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,kBAAkB;YAAE,QAAQ;QAAI;IAC3D,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA+B,GACxC;YAAE,QAAQ;QAAI;IAElB;AACF"}},
    {"offset": {"line": 282, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}